# Dashboard Huawei Solar - 3 kolumny PE≈ÅNA SZEROKO≈öƒÜ
# Sections view - nowy layout HA kt√≥ry u≈ºywa 100% szeroko≈õci ekranu
# COMMIT CHECK: b9e1bd2 - Test git pull

title: Huawei Solar PV
views:
  - title: PrzeglƒÖd
    icon: mdi:solar-power
    type: sections
    max_columns: 3
    sections:
      # SEKCJA 1 (lewa kolumna)
      - type: grid
        column_span: 1
        cards:
          # ZarzƒÖdzanie bateriƒÖ - tytu≈Ç + gauge + entities bez tytu≈Çu
          - type: vertical-stack
            title: ZarzƒÖdzanie bateriƒÖ
            cards:
              # Gauge'y baterii
              - type: horizontal-stack
                cards:
                  - type: gauge
                    entity: sensor.akumulatory_stan_pojemnosci
                    name: Stan Baterii
                    unit: "%"
                    min: 0
                    max: 100
                    needle: true
                    segments:
                      - from: 0
                        color: "#db4437"
                      - from: 20
                        color: "#43a047"
                      - from: 80
                        color: "#db4437"
                  - type: gauge
                    entity: sensor.akumulatory_moc_ladowania_rozladowania
                    name: Moc Baterii
                    unit: "W"
                    min: -5000
                    max: 5000
                    needle: true
                    segments:
                      - from: -5000
                        color: "#db4437"
                      - from: -4000
                        color: "#ffa600"
                      - from: -2000
                        color: "#43a047"
                      - from: 2000
                        color: "#ffa600"
                      - from: 4000
                        color: "#db4437"
              # Entities bez tytu≈Çu
              - type: entities
                entities:
                  - entity: input_text.battery_decision_reason
                    name: üéØ Decyzja
                    icon: mdi:chart-line
                  - entity: input_number.battery_target_soc
                    name: üéØ Target SOC (obliczony o 04:00)
                  - entity: switch.akumulatory_ladowanie_z_sieci
                    name: ≈Åadowanie z sieci
                  - entity: sensor.akumulatory_status
                    name: Status baterii
                  - entity: sensor.bateria_temperatura_maksymalna
                    name: üå°Ô∏è Temperatura baterii (max)
                    icon: mdi:thermometer-high
                  - entity: select.akumulatory_tryb_pracy
                    name: ‚öôÔ∏è Tryb pracy
                state_color: true

          # Pompa ciep≈Ça - tytu≈Ç + gauge + entities bez tytu≈Çu
          - type: vertical-stack
            title: Pompa ciep≈Ça
            cards:
              # Gauge'y temperatury
              - type: horizontal-stack
                cards:
                  - type: gauge
                    entity: sensor.temperatura_co
                    name: Temp. zasilania
                    unit: "¬∞C"
                    min: 15
                    max: 65
                    needle: true
                    segments:
                      - from: 15
                        color: "#2196f3"
                      - from: 20
                        color: "#43a047"
                      - from: 35
                        color: "#ffa600"
                      - from: 50
                        color: "#db4437"
                  - type: vertical-stack
                    cards:
                      - type: gauge
                        entity: sensor.temperatura_cwu
                        name: Temp. CWU
                        unit: "¬∞C"
                        min: 30
                        max: 60
                        needle: true
                        segments:
                          - from: 30
                            color: "#2196f3"
                          - from: 47
                            color: "#43a047"
                          - from: 55
                            color: "#db4437"
                      - type: markdown
                        content: "<center>Cel: {{ state_attr('water_heater.bodynek_nb_tank', 'temperature') }}¬∞C</center>"
              # Status i encje bez tytu≈Çu
              - type: markdown
                content: |
                  {% set sezon = 'üü¢' if is_state('binary_sensor.sezon_grzewczy', 'on') else 'üî¥' %}
                  {% set co = 'üü¢' if is_state('binary_sensor.pc_co_aktywne', 'on') else 'üî¥' %}
                  {% set cwu = 'üü¢' if is_state('binary_sensor.cwu_aktywne', 'on') else 'üî¥' %}
                  {{ sezon }} Sezon Grzewczy ‚Ä¢ {{ co }} CO ‚Ä¢ {{ cwu }} CWU
              - type: entities
                entities:
                  - entity: switch.bodynek_nb_wymus_c_w_u
                    name: Wymu≈õ CWU
                state_color: true

      # SEKCJA 2 (≈õrodkowa kolumna)
      - type: grid
        column_span: 1
        cards:
          # Ceny RCE - tytu≈Ç + ceny godzinowe + encje bez tytu≈Çu
          - type: vertical-stack
            title: Ceny RCE
            cards:
              # Ceny godzinowe (DZI≈ö i JUTRO)
              - type: markdown
                content: |
                  <table cellspacing="0" cellpadding="4" style="width:100%; text-align:center; border-color:#1c1c1c;">
                  <tr><th colspan="4" style="border-color:#1c1c1c;"><b>Dzi≈õ</b></th><th width="40" style="border-color:#1c1c1c;"></th><th colspan="4" style="border-color:#1c1c1c;"><b>Jutro</b></th></tr>
                  <tr><th style="border-color:#1c1c1c;">Godz</th><th style="border-color:#1c1c1c;">Cena</th><th style="border-color:#1c1c1c;">Godz</th><th style="border-color:#1c1c1c;">Cena</th><th style="border-color:#1c1c1c;"></th><th style="border-color:#1c1c1c;">Godz</th><th style="border-color:#1c1c1c;">Cena</th><th style="border-color:#1c1c1c;">Godz</th><th style="border-color:#1c1c1c;">Cena</th></tr>
                  <tr><td style="border-color:#1c1c1c;">06</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h06') }}</td><td style="border-color:#1c1c1c;">14</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h14') }}</td><td style="border-color:#1c1c1c;"></td><td style="border-color:#1c1c1c;">06</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't06') }}</td><td style="border-color:#1c1c1c;">14</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't14') }}</td></tr>
                  <tr><td style="border-color:#1c1c1c;">07</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h07') }}</td><td style="border-color:#1c1c1c;">15</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h15') }}</td><td style="border-color:#1c1c1c;"></td><td style="border-color:#1c1c1c;">07</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't07') }}</td><td style="border-color:#1c1c1c;">15</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't15') }}</td></tr>
                  <tr><td style="border-color:#1c1c1c;">08</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h08') }}</td><td style="border-color:#1c1c1c;">16</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h16') }}</td><td style="border-color:#1c1c1c;"></td><td style="border-color:#1c1c1c;">08</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't08') }}</td><td style="border-color:#1c1c1c;">16</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't16') }}</td></tr>
                  <tr><td style="border-color:#1c1c1c;">09</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h09') }}</td><td style="border-color:#1c1c1c;">17</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h17') }}</td><td style="border-color:#1c1c1c;"></td><td style="border-color:#1c1c1c;">09</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't09') }}</td><td style="border-color:#1c1c1c;">17</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't17') }}</td></tr>
                  <tr><td style="border-color:#1c1c1c;">10</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h10') }}</td><td style="border-color:#1c1c1c;">18</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h18') }}</td><td style="border-color:#1c1c1c;"></td><td style="border-color:#1c1c1c;">10</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't10') }}</td><td style="border-color:#1c1c1c;">18</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't18') }}</td></tr>
                  <tr><td style="border-color:#1c1c1c;">11</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h11') }}</td><td style="border-color:#1c1c1c;">19</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h19') }}</td><td style="border-color:#1c1c1c;"></td><td style="border-color:#1c1c1c;">11</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't11') }}</td><td style="border-color:#1c1c1c;">19</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't19') }}</td></tr>
                  <tr><td style="border-color:#1c1c1c;">12</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h12') }}</td><td style="border-color:#1c1c1c;">20</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h20') }}</td><td style="border-color:#1c1c1c;"></td><td style="border-color:#1c1c1c;">12</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't12') }}</td><td style="border-color:#1c1c1c;">20</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't20') }}</td></tr>
                  <tr><td style="border-color:#1c1c1c;">13</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h13') }}</td><td style="border-color:#1c1c1c;">21</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 'h21') }}</td><td style="border-color:#1c1c1c;"></td><td style="border-color:#1c1c1c;">13</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't13') }}</td><td style="border-color:#1c1c1c;">21</td><td style="border-color:#1c1c1c;">{{ state_attr('sensor.rce_ceny_godzinowe', 't21') }}</td></tr>
                  </table>
              # Encje bez tytu≈Çu
              - type: entities
                entities:
                  - entity: sensor.strefa_taryfowa
                    name: Strefa taryfowa G12w
                    icon: mdi:clock-time-four-outline
                  - entity: sensor.cena_zakupu_energii
                    name: Cena obecna RCE
                    icon: mdi:cash
                  - entity: input_text.battery_cheapest_hours
                    name: RCE najta≈Ñsze godziny
                    icon: mdi:currency-usd

          # Pogoda i prognoza PV - tytu≈Ç + kafelek + encje
          - type: vertical-stack
            title: Pogoda i prognoza PV
            cards:
              - type: weather-forecast
                entity: weather.forecast_dom
                show_forecast: true
                forecast_type: hourly
                show_current: true
              - type: entities
                entities:
                  - entity: sensor.prognoza_pv_dzisiaj
                    name: Prognoza PV dzi≈õ
                    icon: mdi:solar-power
                  - entity: sensor.prognoza_pv_jutro
                    name: Prognoza PV jutro
                    icon: mdi:solar-power

      # SEKCJA 3 (prawa kolumna)
      - type: grid
        column_span: 1
        cards:
          # Produkcja energii - tytu≈Ç + gauge + entities + wykres bez tytu≈Çu
          - type: vertical-stack
            title: Produkcja energii
            cards:
              # Gauge'y PV
              - type: horizontal-stack
                cards:
                  - type: gauge
                    entity: sensor.inwerter_moc_wejsciowa
                    name: Produkcja PV
                    unit: "W"
                    min: 0
                    max: 12000
                    needle: true
                    segments:
                      - from: 0
                        color: "#43a047"
                      - from: 2000
                        color: "#ffa600"
                      - from: 7000
                        color: "#db4437"
                  - type: gauge
                    entity: sensor.nadwyzka_pv
                    name: Nadwy≈ºka PV
                    unit: "W"
                    min: 0
                    max: 12000
                    needle: true
                    segments:
                      - from: 0
                        color: "#43a047"
                      - from: 2000
                        color: "#ffa600"
                      - from: 5000
                        color: "#db4437"
              # Entities bez tytu≈Çu
              - type: entities
                entities:
                  - entity: sensor.produkcja_pv_godzinowa_dc
                    name: Produkcja PV w tej godzinie
                    icon: mdi:clock-outline
                  - entity: sensor.produkcja_pv_dzienna_rzeczywista
                    name: Dzienna produkcja PV
                    icon: mdi:weather-sunny
              # Historia mocy bez tytu≈Çu
              - type: history-graph
                hours_to_show: 24
                entities:
                  - entity: sensor.zuzycie_domu_moc
                    name: Zu≈ºycie domu
                  - entity: sensor.inwerter_moc_czynna
                    name: Moc wyj≈õciowa
                  - entity: sensor.akumulatory_moc_ladowania_rozladowania
                    name: Bateria
                  - entity: sensor.pomiar_mocy_moc_czynna
                    name: Sieƒá

  - title: Statystyki
    icon: mdi:chart-bar
    cards:
      - type: statistics-graph
        title: Bateria - ostatni tydzie≈Ñ
        stat_types:
          - mean
          - min
          - max
        entities:
          - sensor.akumulatory_stan_pojemnosci
        days_to_show: 7

      - type: statistics-graph
        title: Produkcja dzienna
        stat_types:
          - sum
        entities:
          - sensor.inwerter_dzienna_produkcja
        days_to_show: 30
        chart_type: bar
